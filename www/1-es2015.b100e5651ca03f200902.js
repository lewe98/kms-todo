(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"74gq":function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var o=i("mrSG"),r=i("uVvT"),s=i("fXoL"),a=i("TEn/"),n=i("NwP+");let d=(()=>{class e{constructor(e,t,i,o){this.modalCtrl=e,this.storageService=t,this.alertController=i,this.loadingController=o,this.todos=[],this.filteredAufgabenArray=[],this.categories=[],this.catname="",this.loading=this.loadingController.create({message:"Bitte warten...",duration:1500}),this.searchInput="",this.filterCat="",this.refreshTodos(),this.refreshCategories()}refreshTodos(){this.todos=this.storageService.getTodos(),this.filteredAufgabenArray=this.storageService.getTodos(),this.searchInput=""}refreshCategories(){this.categories.length||localStorage.getItem("cats")||this.storageService.addCategorie(new r.a("0","nicht kategorisiert")),this.categories=this.storageService.getCategories()}add(e,t,i){return Object(o.a)(this,void 0,void 0,(function*(){if(e.titel&&e.beschreibung){e.id=this.todos.length,e.autor=t;let o=String((new Date).getMinutes());1===o.length&&(o="0"+o),e.zeit=(new Date).getHours()+":"+o,i||(i="nicht kategorisiert"),e.kategorie=new r.a(i,i),yield this.todos.push(e),yield this.storageService.addTodo(e),yield this.refreshTodos(),yield this.modalCtrl.dismiss()}else alert("Bitte g\xfcltige Daten eintragen.")}))}getCatByName(e){for(const t of this.categories)if(e===t.name)return t}addCategory(e){return Object(o.a)(this,void 0,void 0,(function*(){if(0!==e.length){const t=this.categories.length.toString(),i=new r.a(t,e);this.storageService.addCategorie(i),this.refreshCategories()}else alert("Please enter a valid category name.")}))}setPriority(e,t){const i=this.todos.indexOf(e);e.prioritaet=t,this.todos[i]=e,this.storageService.updateTodo(e)}setCategory(e,t){e.kategorie=t,this.storageService.updateTodo(e),this.refreshTodos()}edit(e){return Object(o.a)(this,void 0,void 0,(function*(){e.titel&&e.beschreibung&&(this.todos=this.todos.map(t=>{if(t.id===e.id)return e.kategorie=this.getCatByName(this.catname),e}),this.storageService.updateTodo(e),yield this.modalCtrl.dismiss())}))}delete(e){return Object(o.a)(this,void 0,void 0,(function*(){this.todos.splice(this.todos.indexOf(e),1),this.storageService.deleteTodo(e),this.refreshTodos()}))}deleteCategorie(e){return Object(o.a)(this,void 0,void 0,(function*(){this.categories.splice(this.categories.indexOf(e),1),this.storageService.deleteCategorie(e),this.refreshCategories()}))}done(e){return Object(o.a)(this,void 0,void 0,(function*(){e.erledigt=!0,this.storageService.updateTodo(e),this.refreshTodos()}))}notDone(e){return Object(o.a)(this,void 0,void 0,(function*(){e.erledigt=!1,this.storageService.updateTodo(e),this.refreshTodos()}))}presentAlertImportTodos(){return Object(o.a)(this,void 0,void 0,(function*(){if(localStorage.getItem("todos")){const e=yield this.alertController.create({header:"Todos \xfcbernehmen?",message:"M\xf6chten sie die erstellten Todos in ihr Profil \xfcbernehmen.<br>Falls nicht werden sie <strong>gel\xf6scht</strong>.",buttons:[{text:"L\xf6schen",role:"cancel",cssClass:"secondary",handler:()=>{localStorage.removeItem("todos")}},{text:"\xdcbernehmen",handler:()=>Object(o.a)(this,void 0,void 0,(function*(){yield(yield this.loading).present();const e=JSON.parse(localStorage.getItem("todos"));localStorage.removeItem("todos"),this.storageService.importToFirebase(e),yield(yield this.loading).onDidDismiss(),this.refreshTodos()}))}]});yield e.present()}}))}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(a.H),s.Rb(n.a),s.Rb(a.a),s.Rb(a.G))},e.\u0275prov=s.Eb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},NKrf:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var o=i("mrSG"),r=i("fXoL"),s=i("ZETX"),a=i("TEn/"),n=i("tyNb"),d=i("74gq"),c=i("3Pt+"),h=i("ofXK");const l=["email"];function g(e,t){if(1&e&&(r.Nb(0,"p",7),r.ic(1),r.Mb()),2&e){const e=r.Xb();r.yb(1),r.kc(" ",e.errors.get("wrongData"),"")}}let u=(()=>{class e{constructor(e,t,i,o){this.authService=e,this.popoverController=t,this.router=i,this.todoService=o,this.errors=new Map,localStorage.getItem("userID")&&this.router.navigate(["/home"])}dismissClickPopover(){return Object(o.a)(this,void 0,void 0,(function*(){yield this.popoverController.dismiss()}))}login(e,t){return Object(o.a)(this,void 0,void 0,(function*(){this.errors.clear(),yield this.dismissClickPopover(),yield this.authService.signIn(e,t).then(()=>Object(o.a)(this,void 0,void 0,(function*(){this.authService.getUser()&&(this.todoService.todos.length>0&&(yield this.todoService.presentAlertImportTodos()),this.authService.isLoggedIn=!0,this.todoService.refreshTodos()),this.router.navigate(["/home"])}))).catch(i=>{"auth/invalid-email"===i.code?this.errors.set("wrongData","Fehlerhaftes Email Format!"):e||t?e?t?t.length<6?this.errors.set("wrongData","Passwort muss mindestens 6 Zeichen lang sein!"):("auth/user-not-found"===i.code||"auth/wrong-password"===i.code)&&this.errors.set("wrongData","E-Mail oder Passwort wurde falsch eingegeben!"):this.errors.set("wrongData","Passwort darf nicht leer sein!"):this.errors.set("wrongData","Email darf nicht leer sein!"):this.errors.set("wrongData","E-Mail und Passwort darf nicht leer sein!")})}))}ionViewDidEnter(){setTimeout(()=>this.emailRef.setFocus(),10)}}return e.\u0275fac=function(t){return new(t||e)(r.Ib(s.a),r.Ib(a.J),r.Ib(n.g),r.Ib(d.a))},e.\u0275cmp=r.Cb({type:e,selectors:[["app-login"]],viewQuery:function(e,t){var i;1&e&&r.lc(l,!0),2&e&&r.bc(i=r.Wb())&&(t.emailRef=i.first)},decls:17,vars:4,consts:[["placeholder","E-Mail","clearOnEdit","false","type","email","required","",1,"ion-text-end",3,"ngModel","ngModelChange"],["email",""],["placeholder","Passwort","clearOnEdit","false","type","password","required","",1,"ion-text-end",3,"ngModel","ngModelChange"],["class","ion-text-end ion-padding-end","style","color:var(--ion-color-danger)",4,"ngIf"],[3,"title","click"],[1,"margin"],[3,"click"],[1,"ion-text-end","ion-padding-end",2,"color","var(--ion-color-danger)"]],template:function(e,t){1&e&&(r.Nb(0,"ion-content"),r.Nb(1,"ion-item"),r.Nb(2,"ion-label"),r.ic(3,"E-Mail*"),r.Mb(),r.Nb(4,"ion-input",0,1),r.Vb("ngModelChange",(function(e){return t.emailForLogIn=e})),r.Mb(),r.Mb(),r.Nb(6,"ion-item"),r.Nb(7,"ion-label"),r.ic(8,"Passwort*"),r.Mb(),r.Nb(9,"ion-input",2),r.Vb("ngModelChange",(function(e){return t.passwordForLogIn=e})),r.Mb(),r.Mb(),r.gc(10,g,2,1,"p",3),r.Nb(11,"ion-button",4),r.Vb("click",(function(){return t.login(t.emailForLogIn,t.passwordForLogIn)})),r.ic(12,"Login"),r.Mb(),r.Nb(13,"p",5),r.ic(14," Noch keinen Account? Dann registriere dich "),r.Nb(15,"a",6),r.Vb("click",(function(){return t.dismissClickPopover(),t.router.navigate(["registrierung"])})),r.ic(16," hier! "),r.Mb(),r.Mb(),r.Mb()),2&e&&(r.yb(4),r.ac("ngModel",t.emailForLogIn),r.yb(5),r.ac("ngModel",t.passwordForLogIn),r.yb(1),r.ac("ngIf",t.errors.get("wrongData")),r.yb(1),r.ac("title","Login"))},directives:[a.h,a.n,a.r,a.m,a.M,c.f,c.d,c.e,h.i,a.f],styles:["ion-content[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}"]}),e})()},"NwP+":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var o=i("uVvT"),r=i("fXoL"),s=i("ZETX");let a=(()=>{class e{constructor(e){this.authService=e}static parsObjectArrayToString(e){const t=[];return e.map(e=>{t.push(JSON.stringify(e))}),t}static parsStringToObjectArray(e){const t=[];return e.map(e=>{const i=JSON.parse(e);t.push(i)}),t}getCategories(){return this.authService.isLoggedIn?this.getCategoriesFirebase():this.getCategoriesLocalStorage()}addCategorie(e){this.authService.isLoggedIn?this.addCategorieFirebase(e):this.addCategorieLocalStorage(e)}deleteCategorie(e){this.authService.isLoggedIn?this.deleteCategorieFirebase(e):this.deleteCategorieLocalStorage(e)}getTodos(){return this.authService.isLoggedIn?this.getTodosFirebase():this.getTodosLocalStorage()}addTodo(e){this.authService.isLoggedIn?this.addTodoFirebase(e):this.addTodoLocalStorage(e)}updateTodo(e){this.authService.isLoggedIn?this.updateTodoFirebase(e):this.updateTodoLocalStorage(e)}deleteTodo(e){this.authService.isLoggedIn?this.deleteTodoFirebase(e):this.deleteTodoLocalStorage(e)}importToFirebase(e){e.forEach(e=>{this.addTodoFirebase(e)})}updateTodosLocalstorage(e){localStorage.setItem("todos",JSON.stringify(e))}updateCategoriesLocalstorage(e){localStorage.setItem("cats",JSON.stringify(e))}getTodosLocalStorage(){const e=JSON.parse(localStorage.getItem("todos"));return null!==e?e:[]}getCategoriesLocalStorage(){const e=JSON.parse(localStorage.getItem("cats"));return null!==e?e:[]}addTodoLocalStorage(e){let t=this.getTodosLocalStorage();t?(t.push(e),this.updateTodosLocalstorage(t)):(t=[],t.push(e),this.updateTodosLocalstorage(t))}addCategorieLocalStorage(e){const t=this.getCategoriesLocalStorage();t?(t.push(e),this.updateCategoriesLocalstorage(t)):(t.push(new o.a("0","nicht kategorisiert")),t.push(e),this.updateCategoriesLocalstorage(t))}updateTodoLocalStorage(e){const t=this.getTodosLocalStorage().map(t=>t.id===e.id?e:t);this.updateTodosLocalstorage(t)}deleteTodoLocalStorage(e){const t=this.getTodosLocalStorage();t.splice(t.indexOf(e),1),this.updateTodosLocalstorage(t)}deleteCategorieLocalStorage(e){const t=this.getCategoriesLocalStorage();t.splice(t.indexOf(e),1),this.updateCategoriesLocalstorage(t)}getTodosFirebase(){return e.parsStringToObjectArray(this.authService.getUser().todos)}getCategoriesFirebase(){return e.parsStringToObjectArray(this.authService.getUser().kategorien)}addTodoFirebase(e){const t=this.authService.getUser();t.todos.push(JSON.stringify(e)),this.authService.updateUser(t)}addCategorieFirebase(e){const t=this.authService.getUser();t.kategorien.push(JSON.stringify(e)),this.authService.updateUser(t)}updateTodoFirebase(t){const i=this.authService.getUser(),o=e.parsStringToObjectArray(i.todos);i.todos=e.parsObjectArrayToString(o.map(e=>e.id===t.id?t:e)),this.authService.updateUser(i)}deleteTodoFirebase(e){const t=this.authService.getUser();t.todos.splice(t.todos.indexOf(JSON.stringify(e)),1),this.authService.updateUser(t)}deleteCategorieFirebase(e){const t=this.authService.getUser();t.kategorien.splice(t.kategorien.indexOf(JSON.stringify(e)),1),this.authService.updateUser(t)}}return e.\u0275fac=function(t){return new(t||e)(r.Rb(s.a))},e.\u0275prov=r.Eb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},ZETX:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var o=i("mrSG"),r=i("uVvT");class s{constructor(e,t,i){this.kategorien=[JSON.stringify(new r.a("0","nicht kategorisiert"))],this.email=e,this.nutzername=t,this.profilbild=i}}var a=i("lJxs"),n=i("NKrf"),d=i("fXoL"),c=i("tyNb"),h=i("I/3d"),l=i("UbJi"),g=i("TEn/");let u=(()=>{class e{constructor(e,t,i,o,r){this.router=e,this.afs=t,this.afAuth=i,this.loadingController=o,this.popoverController=r,this.isLoggedIn=!1,this.loading=this.loadingController.create({message:"Bitte warten...",duration:1500}),this.userCollection=t.collection("users")}static copyAndPrepare(e){const t=Object.assign({},e);return delete t.id,t.nutzername=t.nutzername||null,t.profilbild=t.profilbild||null,t.todos=t.todos||[],t.kategorien=t.kategorien||[],t}presentPopoverLogin(e){return Object(o.a)(this,void 0,void 0,(function*(){const t=yield this.popoverController.create({component:n.a,event:e,translucent:!0,componentProps:{}});return yield t.present()}))}persist(t,i){this.userCollection.doc(i).set(e.copyAndPrepare(t))}getUser(){return this.user}findById(e){return this.userCollection.doc(e).snapshotChanges().pipe(Object(a.a)(t=>{const i=t.payload.data();return i&&(i.id=e),Object.assign({},i)}))}signUp(e,t,i,r){return Object(o.a)(this,void 0,void 0,(function*(){yield this.afAuth.createUserWithEmailAndPassword(t,i).then(i=>Object(o.a)(this,void 0,void 0,(function*(){this.persist(new s(t,e,i.user.photoURL),i.user.uid),this.subUser=this.findById(i.user.uid).subscribe(e=>{this.user=e,this.isLoggedIn=!0,r()}),localStorage.setItem("userID",i.user.uid),yield this.router.navigate(["/home"])}))).catch(e=>{alert(e)})}))}signIn(e,t){return Object(o.a)(this,void 0,void 0,(function*(){yield(yield this.loading).present(),yield this.afAuth.signInWithEmailAndPassword(e,t).then(e=>{localStorage.setItem("userID",e.user.uid),this.subUser=this.findById(e.user.uid).subscribe(e=>Object(o.a)(this,void 0,void 0,(function*(){this.user=e})))}).catch(e=>{alert(e)}),yield(yield this.loading).onDidDismiss()}))}logOut(){return Object(o.a)(this,void 0,void 0,(function*(){this.subUser&&this.subUser.unsubscribe(),this.user=void 0,localStorage.clear(),yield this.afAuth.signOut(),setTimeout(()=>{this.isLoggedIn=!1},800)}))}updateUser(t){return Object(o.a)(this,void 0,void 0,(function*(){yield this.userCollection.doc(t.id).update(e.copyAndPrepare(t))}))}}return e.\u0275fac=function(t){return new(t||e)(d.Rb(c.g),d.Rb(h.a),d.Rb(l.a),d.Rb(g.G),d.Rb(g.J))},e.\u0275prov=d.Eb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},uVvT:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));class o{constructor(e,t){this.id="0",this.name="nicht kategorisiert",this.id=e,this.name=t}}}}]);